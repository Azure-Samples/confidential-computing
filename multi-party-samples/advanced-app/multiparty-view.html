<!DOCTYPE html>
<html>
<head>
    <title>Multi-Party Confidential Computing Demo</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { display: flex; flex-direction: column; height: 100vh; font-family: 'Segoe UI', sans-serif; background: #1a1a2e; overflow: hidden; }
        .header { 
            background: #1a1a2e; 
            color: white; 
            padding: 8px 20px;
            text-align: center;
            border-bottom: 2px solid #333;
        }
        .header h1 { font-size: 18px; font-weight: 500; margin-bottom: 4px; }
        .header p { font-size: 12px; color: #888; }
        .container { display: flex; flex-direction: row; flex: 1; overflow: hidden; }
        .pane { 
            display: flex; 
            flex-direction: column;
            border: 2px solid #333;
            min-width: 200px;
            overflow: hidden;
        }
        .label { 
            padding: 8px 10px; 
            font-weight: bold;
            font-size: 11px;
            text-align: center;
            flex-shrink: 0;
        }
        .label.confidential { background: #28a745; color: white; }
        .label.standard { background: #dc3545; color: white; }
        .label .subtitle { display: block; font-size: 9px; font-weight: normal; opacity: 0.9; margin-top: 2px; }
        .label .key-name { display: block; font-size: 9px; font-family: monospace; background: rgba(255,255,255,0.2); padding: 2px 6px; border-radius: 3px; margin-top: 4px; }
        iframe { flex: 1; width: 100%; border: none; background: white; }
        .resizer {
            width: 6px;
            background: #333;
            cursor: col-resize;
            flex-shrink: 0;
            transition: background 0.2s;
        }
        .resizer:hover, .resizer.active {
            background: #0078d4;
        }
        .legend {
            background: #252545;
            padding: 6px 20px;
            display: flex;
            justify-content: center;
            gap: 30px;
            font-size: 10px;
            color: #ccc;
            flex-shrink: 0;
        }
        .legend-item { display: flex; align-items: center; gap: 6px; }
        .legend-dot { width: 8px; height: 8px; border-radius: 50%; }
        .legend-dot.green { background: #28a745; }
        .legend-dot.red { background: #dc3545; }
        .no-select { user-select: none; -webkit-user-select: none; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üîê Multi-Party Confidential Computing Demonstration</h1>
        <p>Each company has their own Key Vault and SKR key - only their confidential container can release it</p>
    </div>
    <div class="legend">
        <div class="legend-item">
            <div class="legend-dot green"></div>
            <span>Confidential containers can attest and release keys</span>
        </div>
        <div class="legend-item">
            <div class="legend-dot red"></div>
            <span>Standard containers cannot attest - key release fails</span>
        </div>
    </div>
    <div class="container" id="container">
        <div class="pane" id="pane0" style="flex: 1;">
            <div class="label confidential">
                ‚úÖ CONTOSO (Confidential) <span class="subtitle">AMD SEV-SNP TEE ‚Ä¢ Key Vault: kvacrwvgzmaeta</span> <span class="key-name">üîë contoso-secret-key</span>
            </div>
            <iframe src="http://contoso-02050140.eastus.azurecontainer.io" title="Contoso - Confidential Container"></iframe>
        </div>
        <div class="resizer" data-pane="0"></div>
        <div class="pane" id="pane1" style="flex: 1;">
            <div class="label confidential">
                ‚úÖ FABRIKAM (Confidential) <span class="subtitle">AMD SEV-SNP TEE ‚Ä¢ Key Vault: kvacrwvgzmaetb</span> <span class="key-name">üîë fabrikam-secret-key</span>
            </div>
            <iframe src="http://fabrikam-02050140.eastus.azurecontainer.io" title="Fabrikam - Confidential Container"></iframe>
        </div>
        <div class="resizer" data-pane="1"></div>
        <div class="pane" id="pane2" style="flex: 1;">
            <div class="label confidential">
                ‚úÖ WOODGROVE BANK (Confidential) <span class="subtitle">AMD SEV-SNP TEE ‚Ä¢ Key Vault: kvacrwvgzmaetc ‚Ä¢ Cross-company access</span> <span class="key-name">üîë woodgrove-secret-key + Partners</span>
            </div>
            <iframe src="http://woodgrove-02050140.eastus.azurecontainer.io" title="Woodgrove Bank - Confidential Container"></iframe>
        </div>
        <div class="resizer" data-pane="2"></div>
        <div class="pane" id="pane3" style="flex: 1;">
            <div class="label standard">
                ‚ùå SNOOPER (Standard - No TEE) <span class="subtitle">Cannot attest ‚Ä¢ Tries to access: kvacrwvgzmaeta</span> <span class="key-name" style="background: rgba(0,0,0,0.2);">üîí ACCESS DENIED</span>
            </div>
            <iframe src="http://snooper-02050140.eastus.azurecontainer.io" title="Snooper - Standard Container (No TEE)"></iframe>
        </div>
    </div>
    <script>
        const container = document.getElementById('container');
        const panes = document.querySelectorAll('.pane');
        const resizers = document.querySelectorAll('.resizer');
        let activeResizer = null;
        let startX = 0;
        let startWidths = [];

        resizers.forEach(resizer => {
            resizer.addEventListener('mousedown', (e) => {
                activeResizer = resizer;
                activeResizer.classList.add('active');
                startX = e.clientX;
                document.body.classList.add('no-select');
                
                // Store current widths in pixels
                startWidths = Array.from(panes).map(p => p.getBoundingClientRect().width);
                
                // Disable pointer events on iframes during resize
                document.querySelectorAll('iframe').forEach(f => f.style.pointerEvents = 'none');
                
                e.preventDefault();
            });
        });

        document.addEventListener('mousemove', (e) => {
            if (!activeResizer) return;
            
            const paneIndex = parseInt(activeResizer.dataset.pane);
            const delta = e.clientX - startX;
            
            const newWidth1 = Math.max(200, startWidths[paneIndex] + delta);
            const newWidth2 = Math.max(200, startWidths[paneIndex + 1] - delta);
            
            // Only apply if both panes stay above minimum
            if (newWidth1 >= 200 && newWidth2 >= 200) {
                panes[paneIndex].style.flex = 'none';
                panes[paneIndex].style.width = newWidth1 + 'px';
                panes[paneIndex + 1].style.flex = 'none';
                panes[paneIndex + 1].style.width = newWidth2 + 'px';
            }
        });

        document.addEventListener('mouseup', () => {
            if (activeResizer) {
                activeResizer.classList.remove('active');
                activeResizer = null;
                document.body.classList.remove('no-select');
                document.querySelectorAll('iframe').forEach(f => f.style.pointerEvents = 'auto');
            }
        });

        // Double-click to reset all panes to equal width
        resizers.forEach(resizer => {
            resizer.addEventListener('dblclick', () => {
                panes.forEach(p => {
                    p.style.flex = '1';
                    p.style.width = '';
                });
            });
        });
    </script>
</body>
</html>
